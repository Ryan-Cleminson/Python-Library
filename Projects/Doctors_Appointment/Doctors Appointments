// Name: Ryan Cleminson// Class: SDD// Date: 30/10/2017/*****************************************                 Constant*****************************************/LET _arraysize = 100LET _AppTime = 7LET _AppDay = 8/*****************************************                   DIM*****************************************/BEGIN GLOBALSBEGIN RECORD PDetailsDIM PName AS STR255DIM AppointDay AS SHORTDIM AppointTime AS SHORTEND RECORDDIM Times(_AppDay,_AppTime) AS BOOLEANDIM AppointInfo(_AppDay,_AppTime) AS STR255DIM Details AS PDetailsDIM Fpath AS FSSPECEND GLOBALS/*****************************************                Interface*****************************************/LOCAL FN InterfaceTEXT _venice,44,_BoldBit%PRINT %(280,100)"Doctors Appointment"TEXT _venice,18END FN/*****************************************                Load File*****************************************/LOCAL FN LoadFileDIM index AS SHORTDIM option AS STR255IF(Files$(_FSSPECOPEN, , "Open File...", Fpath))OPEN "I", 1, @FpathFOR index = 1 TO 5 STEP 1READ #1, DetailsFN TRUNCATE(Details.PName)PRINT Details.PName, Details.AppointDay, Details.AppointTimeLET AppointInfo(Details.AppointDay,Details.AppointTime) = Details.PNameLET Times(Details.AppointDay,Details.AppointTime) = 1NEXT/*DIM x AS SHORTDIM y AS SHORTFOR x = 1 TO 7FOR y = 1 TO 6PRINT x,y, ,AppointInfo(x,y)NEXTNEXT*/CLOSE #1ELSEPRINT "Unable to read file."END IFINPUT optionEND FN/*****************************************v                Title*****************************************/LOCAL FN Title// DIMDIM option AS STR255// MainLONG COLOR (20*256), (25*256), (124*256), _false:CLSTEXT _times,100, _boldBit%COLOR _zWhitePRINT %(350,300) "Doctors"PRINT %(225,390) "Appointment"TEXT _times,40PEN 15// Cross 1PLOT 100,90 TO 100,150PLOT 70,120 TO 130,120// Cross 2PLOT 270,90 TO 270,150PLOT 240,120 TO 300,120// Cross 4PLOT 730,90 TO 730,150PLOT 700,120 TO 760,120// Cross 3PLOT 900,90 TO 900,150PLOT 870,120 TO 930,120// Cross Top-LeftINPUT optionEND FN/*****************************************          Patient First Name Check*****************************************/LOCAL FN PFName(PFname AS STR255) AS STR255// DIMDIM option AS STR255DIM Flag AS BOOLEANDIM index AS SHORTDIM NameLen AS SHORTDIM LetterCheck AS STR255DIM AppDay AS STR255DIM AppDayNum AS SHORTDIM AppTime AS SHORTDIM AvailibleFlag AS BOOLEAN// MAINDODOINPUT "Patient First Name: ";PFnameUNTIL PFname <> ""LET index = 0LET Flag = 1LET LetterCheck = ""LET NameLen = 0LET NameLen = LEN(PFname)DOLET index = index + 1LET LetterCheck = MID$(PFname,index,1)IF ASC(LetterCheck) < 65 OR ASC(LetterCheck) > 90 OR ASC(LetterCheck) < 97 OR ASC(LetterCheck) > 122//LET Flag = 1//END IFUNTIL index = NameLenIF Flag = 0PRINT "*Please input a valid name"LET PFname = ""END IFUNTIL Flag = 1END FN = PFname/*****************************************            Make Appointment*****************************************/LOCAL FN Make_Appointment// DIMDIM option AS STR255DIM PFname AS STR255DIM PLname AS STR255DIM Flag AS BOOLEANDIM index AS SHORTDIM NameLen AS SHORTDIM LetterCheck AS STR255DIM AppDay AS STR255DIM AppDayNum AS SHORTDIM AppTime AS SHORTDIM AvailibleFlag AS BOOLEAN// MainPRINT "Create Appointment"PRINT "Please enter the relevant details which fulfill the following fields and press enter to continue"//// First Name//LET PFname = FN PFName(PFname)//// Appointment Dates//DOIF AvailibleFlag = 1PRINT "*Day and time you have requested DAY: "AppDay" TIME: "AppTime" are already booked please choose another day and time"END IFLET AvailibleFlag = 0LET AppDay = ""LET AppTime = 0LET AppDayNum = 0LET Flag = _trueLET index = 0// DAYDOINPUT "Appointment Day: "; AppDayIF AppDay = "Monday" OR AppDay = "monday"LET AppDayNum = 1ELSE IF AppDay = "Tuesday" OR AppDay = "tuesday"LET AppDayNum = 2ELSE IF AppDay = "Wednesday" OR AppDay = "wednesday"LET AppDayNum = 3ELSE IF AppDay = "Thursday" OR AppDay = "thursday"LET AppDayNum = 4ELSE IF AppDay = "Friday" OR AppDay = "friday"LET AppDayNum = 5ELSELET AppDayNum = 10END IFEND IFEND IFEND IFEND IFIF AppDayNum = 10PRINT "*Please input a valid Day"END IFUNTIL AppDayNum != 10// TIMEDOINPUT "Time: " AppTimeLET AppTime = AppTime - 3LET index = 0LET Flag = _trueIF AppTime < 1 OR AppTime > 6LET Flag = _falseEND IFUNTIL Flag = _trueLET AvailibleFlag = 0/*PRINT PFnameprint PLname*/IF Times(AppDayNum,AppTime) = 0LET Times(AppDayNum,AppTime) = 1LET AppointInfo(AppDayNum,AppTime) = PFnameELSE LET AvailibleFlag = 1END IF///*PRINT Details.PFName(AppDayNum,AppTime)PRINT Details.PLName(AppDayNum,AppTime)PRINT Times(AppDayNum,AppTime)STOP*///LET AppTime = AppTime + 3UNTIL AvailibleFlag = 0END FN/*****************************************            Find Appointments*****************************************/LOCAL FN Find_Appointment//DIMDIM option AS STR255DIM PFname AS STR255DIM PLname AS STR255DIM Flag AS BOOLEANDIM index AS SHORTDIM NameLen AS SHORTDIM LetterCheck AS STR255DIM AppDay AS STR255DIM AppDayNum AS SHORTDIM AppTime AS SHORTDIM AvailibleFlag AS BOOLEANDIM Day(_arraysize) AS SHORTDIM Time(_arraysize) AS SHORTDIM StopFlag AS BOOLEANDOLET StopFlag = _falseCLSIF index = 1PRINT "That patient does not have any appointments"INPUT "Press Y to search again or N to go back to the main menu: "; optionIF option = "N" OR option = "n"LET StopFlag = _trueELSE IF option = "Y" OR option = "y"LET StopFlag = _falseEND IFEND IFEND IFIF StopFlag = _falseCLS//MAINPRINT "Find Appointment"PRINT "Please enter the  name of the patient and press enter to continue"////First Name//FN PFName(PFname)////Last Name///*FN PLName(PLname)*/LET index = 1FOR AppDayNum = 1 TO 7FOR AppTime = 1 TO 6IF AppointInfo(AppDayNum,AppTime) = PFnameLET Day(index) = AppDayNumLET Time(index) = AppTimeLET index = index + 1END IFNEXTNEXTEND IFUNTIL index > 1 OR StopFlag = _trueIF index > 1CLSPRINT "First Name: "PFnamePRINT "Appointment Times: "PRINT "Days: "LET index = 1DO IF Day(index) = 1PRINT "Monday"IF Day(index) = 2PRINT "Tuesday"IF Day(index) = 3PRINT "Wednesday"IF Day(index) = 4PRINT "Thursday"IF Day(index) = 5PRINT "Friday"IF Day(index) = 6PRINT "Saturday"IF Day(index) = 7PRINT "Sunday"END IFEND IFEND IFEND IFEND IFEND IFEND IFLET index = index + 1UNTIL Day(index) = 0PRINT "Times: "DO IF Time(index) = 1PRINT Time(index) + 3IF Time(index) = 2PRINT Time(index) + 3IF Time(index) = 3PRINT Time(index) + 3IF Time(index) = 4PRINT Time(index) + 3END IFEND IFEND IFEND IFUNTIL Time(index) = 0INPUT "Press enter to return to the menu: "; optionEND IFEND FN/*****************************************                List Week*****************************************/LOCAL FN List_Week TEXT _times, 30, _boldBit%//DIMDIM weekDayLabels(8) AS STR255DIM timeDayLabels(7) AS STR255DIM index AS SHORTDIM AppDay AS STR255DIM AppDayNum AS SHORTDIM AppTime AS SHORTDIM option AS STR255DIM Day AS SHORTDIM Hour AS SHORTDIM x AS SHORTDIM y AS SHORTDIM ColIndex AS SHORTDIM RowsIndex AS SHORTDIM TableHeight AS SHORTDIM TableLength AS SHORT//MAINLET weekDayLabels(1) = "Mon"LET weekDayLabels(2) = "Tue"LET weekDayLabels(3) = "Wed"LET weekDayLabels(4) = "Thu"LET weekDayLabels(5) = "Fri"LET weekDayLabels(6) = "Sat"LET weekDayLabels(7) = "Sun"LET timeDayLabels(1) = "4:00 "LET timeDayLabels(2) = "5:00 "LET timeDayLabels(3) = "6:00 "LET timeDayLabels(4) = "7:00 "LET timeDayLabels(5) = "8:00 "LET timeDayLabels(6) = "9:00 "PRINT %(500,30) "Days"PRINT %(10,300) "Times"LET TableHeight = 50LET TableLength = 100Index=0y = 74x=105FOR ColIndex = 1 TO _AppDay STEP 1y= 74FOR RowsIndex = 1 TO _AppTime STEP 1COLOR = _zWhiteTEXT _monaco,24,0LONG COLOR (20*256), (25*256), (124*256), _falseSELECT ColIndexCASE 1 AND RowsIndex = 1LONG COLOR (40*255),(114*255),(68*255)CASE >1 AND RowsIndex = 1COLOR _zWhitePRINT %(x+20,y+20) weekDayLabels(ColIndex-1)END SELECTSELECT RowsIndexCASE >1 AND ColIndex = 1COLOR _zWhiteIndex = Index + 1PRINT %(x,y+28) timeDayLabels(Index)END SELECTFOR Day =1 TO 7 STEP 1FOR Hour =1 TO 6 STEP 1IF AppointInfo(day,hour) <> "" AND RowsIndex-1 = hour AND ColIndex-1 = daySELECT LEN(AppointInfo(day,hour)) CASE =<4TEXT _monaco, 16,0CASE =<6 AND LEN(AppointInfo(day,hour)) >4TEXT _monaco, 12,0CASE =<9  AND LEN(AppointInfo(day,hour)) >6TEXT _monaco, 10,0CASE >= 10 TEXT _monaco, 8,0CASE ELSETEXT _monaco, 12,0END SELECTLONG COLOR (15*255),(18*255),(61*255), _falseLONG COLOR (15*255),(18*255),(61*255)PEN 1BOX FILL x-3,y-3 TO x+TableLength,y+TableHeightCOLOR _zWhitePRINT %(x+25,(y+TableHeight-18)) AppointInfo(day,hour)TEXT _monaco, 12,0END IFNEXT NEXT COLOR _zWhitePEN 1BOX x-3,y-3 TO x+TableLength,y+TableHeighty= y+TableHeightNEXTx=x+TableLengthNEXTPRINT %(10,700);:INPUT "Press enter to go to the Main Menu: "; optionEND FN/*****************************************           Todays Appointments*****************************************/LOCAL FN Todays_Appointments//DIMDIM weekDayLabels AS STR255DIM timeDayLabels AS SHORTDIM index AS SHORTDIM AppDay AS STR255DIM AppDayNum AS SHORTDIM AppTime AS SHORTDIM option AS SHORTDIM Time(_arraysize) AS SHORTDIM x AS SHORTDIM y AS SHORTDIM TableHeight AS SHORTDIM TableLength AS SHORT//MAINDOCLSFN interfaceIF AppDayNum <= 0 OR AppDayNum >= 8PRINT "*Please enter a day between 1 and 7"LET AppDayNum = 1END IFPRINT "Please enter one of the following numbers relevant to the day you would like"PRINT "1. Monday"PRINT "2. Tuesday"PRINT "3. Wednesday"PRINT "4. Thursday"PRINT "5. Friday"PRINT "6. Saturday"PRINT "7. Sunday"INPUT "Day: "; AppDayNumUNTIL AppDayNum > 0 AND AppDayNum < 8SELECT AppDayNumCASE 1LET AppDay = "Monday"CASE 2LET AppDay = "Tuesday"CASE 3LET AppDay = "Wednesday"CASE 4LET AppDay = "Thursday"CASE 5LET AppDay = "Friday"CASE 6LET AppDay = "Saturday"CASE 7LET AppDay = "Sunday"END SELECTCLSLET timeDayLabels = 0LET x = 300LET y = 250PRINT %(450,100)"Day:"PRINT %(50,500)"Sessions"PRINT %(x+125,200) AppDayLET TableLength = 70LET TableHeight = -79FOR timeDayLabels = 4 TO 9 STEP 1PRINT %(300,y + 50) timeDayLabelsLET y = y + 80COLOR _zWhitePEN 1BOX x-3,y-3 TO x+TableLength,y+TableHeightNEXTLET y = 250LET x = 400LET TableLength = 230LET TableHeight = - 79FOR timeDayLabels = 1 TO 6 STEP 1PRINT %(x,y+50) AppointInfo(AppDayNum,timeDayLabels)LET y = y + 80COLOR _zWhitePEN 1BOX x-3,y-3 TO x+TableLength,y+TableHeightNEXTINPUT option//PRINT %(100,900) "Press enter to go to the Main Menu: ";INPUT optionEND FN/*****************************************                Menu*****************************************/LOCAL FN ChoiceMenu// DIMDIM option AS SHORT// MAINDOCLSFN InterfacePRINT %(125,150)"Please enter one of the following numbers relevant to the option you would like"PRINT "1. Make an Appointment"PRINT "2. Find Appointment"PRINT "3. List of whole week"PRINT "4. Todays AppointmentsPRINT "5. Quit"INPUT "Option: "; optionIF option > 5PRINT "* Please enter a number between 1 and 5"END IFSELECT optionCASE 1CLSFN Make_AppointmentCASE 2CLSFN Find_AppointmentCASE 3CLSFN List_WeekCASE 4CLSFN Todays_AppointmentsEND SELECTUNTIL option = 5END FN/*****************************************              Main Program*****************************************/WINDOW 1, "Doctors Appointment", (0,0)-(1000,800)FN LoadFileFN TitleCLSFN ChoiceMenuSTOP